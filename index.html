<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mydlak Architektur</title>
    <meta name="description" content="Mydlak Architektur - Gestaltung mit Vision und Präzision">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://umami-ten-liart.vercel.app/script.js"
        data-website-id="863abb7a-77c4-4a76-b779-dff207e1e91d"></script>
</head>

<body class="page-enter">
    <nav class="main-nav">
        <div class="nav-content">
            <a href="/" class="nav-logo">Mydlak Architektur</a>
            <ul class="nav-menu">
                <li><a href="/buero/">Büro</a></li>
                <li><a href="#" id="kontakt-btn">Kontakt</a></li>
            </ul>
        </div>
    </nav>

    <!-- Contact Side Panel -->
    <div class="contact-overlay" id="contact-overlay"></div>
    <div class="contact-panel" id="contact-panel">
        <button class="close-btn" id="close-btn">&times;</button>
        <div class="contact-panel-content" id="contact-content">
            <h2>Kontakt</h2>
            <div class="contact-info-simple">
                <p>Justyna Mydlak<br>
                    MSc Architektin USI AAM<br>
                    Mydlak Architektur GmbH<br>
                    Via Prau da Cuort 6<br>
                    7153 Falera<br>
                    <a href="mailto:justyna@mydlak.ch">Email</a>
                </p>
            </div>
        </div>
    </div>

    <div class="container">
        <main>
            <section class="hero">
                <h1>Mydlak Architektur</h1>
                <p class="tagline"></p>
            </section>
        </main>

        <footer class="footer-extended">
            <div class="footer-links">
                <a href="/impressum/">Impressum</a>
                <a href="/datenschutz/">Datenschutz</a>
            </div>
        </footer>
    </div>

    <script>
        // Scroll to top if coming from legal page back button
        if (sessionStorage.getItem('scrollToTop') === 'true') {
            window.scrollTo(0, 0);
            sessionStorage.removeItem('scrollToTop');
        }

        // Event tracking via virtual pageviews
        function trackEvent(eventName) {
            try {
                if (typeof __cfBeacon !== 'undefined' && __cfBeacon.load) {
                    __cfBeacon.load('pageview', {
                        virtualPage: '/event/' + eventName
                    });
                }
            } catch (e) {
                // Silently fail if tracking is not available
                console.log('Tracking not available:', e);
            }
        }

        // Contact Panel Toggle
        const kontaktBtn = document.getElementById('kontakt-btn');
        const closeBtn = document.getElementById('close-btn');
        const contactPanel = document.getElementById('contact-panel');
        const contactOverlay = document.getElementById('contact-overlay');

        kontaktBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (typeof umami !== 'undefined') umami.track('kontakt-opened');
            trackEvent('kontakt-opened-from-index');
            contactPanel.classList.add('active');
            contactOverlay.classList.add('active');
        });

        closeBtn.addEventListener('click', () => {
            contactPanel.classList.remove('active');
            contactOverlay.classList.remove('active');
        });

        contactOverlay.addEventListener('click', () => {
            contactPanel.classList.remove('active');
            contactOverlay.classList.remove('active');
        });

        // Remove page-enter class after animation
        setTimeout(() => {
            document.body.classList.remove('page-enter');
        }, 600);

        // Pocketbase helpers & rendering (contact)
        const PB_BASE = 'https://mydlak-pocketbase.fly.dev';

        async function fetchCollectionFirst(collection) {
            const url = `${PB_BASE}/api/collections/${collection}/records?perPage=1`;
            const res = await fetch(url);
            if (!res.ok) throw new Error(`Failed to fetch ${collection}`);
            const data = await res.json();
            return (data && Array.isArray(data.items) && data.items.length) ? data.items[0] : null;
        }

        (function initContact() {
            const el = document.getElementById('contact-content');
            if (!el) return;

            fetchCollectionFirst('contact')
                .then(rec => {
                    if (!rec) return;
                    if (rec.html) {
                        el.innerHTML = rec.html;
                        return;
                    }
                    const name = rec.name || 'Justyna Mydlak';
                    const title = rec.title || 'MSc Architektin USI AAM';
                    const company = rec.company || 'Mydlak Architektur GmbH';
                    const address = rec.address || 'Via Prau da Cuort 6<br>7153 Falera';
                    const email = rec.email || 'justyna@mydlak.ch';
                    el.innerHTML = `
                        <h2>Kontakt</h2>
                        <div class="contact-info-simple">
                            <p>${name}<br>${title}<br>${company}<br>${address}<br><a href="mailto:${email}">Email</a></p>
                        </div>`;
                })
                .catch(err => {
                    console.log('contact load error', err);
                });
        })();
    </script>
    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js'
        data-cf-beacon='{"token": "25c2069b2f03483c8a41850f2fc04774"}'></script>
    <!-- End Cloudflare Web Analytics -->
</body>

</html>