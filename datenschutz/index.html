<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datenschutz – Mydlak Architektur</title>
    <meta name="description"
        content="Datenschutzerklärung der Mydlak Architektur GmbH. Informationen zum Umgang mit personenbezogenen Daten.">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://umami-ten-liart.vercel.app/script.js"
        data-website-id="863abb7a-77c4-4a76-b779-dff207e1e91d"></script>
</head>

<body class="page-enter legal-page-body">
    <nav class="main-nav">
        <div class="nav-content">
            <a href="/" class="nav-logo">Mydlak Architektur</a>
            <ul class="nav-menu">
                <li><a href="/buero/">Büro</a></li>
                <li><a href="#" id="kontakt-btn">Kontakt</a></li>
            </ul>
        </div>
    </nav>

    <!-- Contact Side Panel -->
    <div class="contact-overlay" id="contact-overlay"></div>
    <div class="contact-panel" id="contact-panel">
        <button class="close-btn" id="close-btn">&times;</button>
        <div class="contact-panel-content" id="contact-content">
            <h2>Kontakt</h2>
            <div class="contact-info-simple">
                <p>Justyna Mydlak<br>
                    MSc Architektin USI AAM<br>
                    Mydlak Architektur GmbH<br>
                    Via Prau da Cuort 6<br>
                    7153 Falera</p>
                <a href="mailto:justyna@mydlak.ch">Email</a>
            </div>
        </div>
    </div>

    <div class="container">
        <main class="legal-page-main">
            <button class="legal-close-btn" id="close-btn-legal">&times;</button>

            <article class="legal-content">
                <h1>Datenschutz</h1>

                <section class="legal-section">
                    <h2>Informationen zum Datenschutz</h2>
                    <p>Diese Website nutzt datenschutzfreundliche Analysedienste (Umami und Cloudflare Web Analytics),
                        um die Nutzung der Website zu verstehen und zu verbessern. Dabei werden keine personenbezogenen
                        Daten erfasst und keine Cookies gespeichert. Es werden lediglich anonymisierte Statistiken wie
                        Seitenaufrufe und verwendete Browser erhoben.</p>
                </section>

                <section class="legal-section">
                    <h2>Verantwortliche Stelle</h2>
                    <p>Mydlak Architektur GmbH<br>
                        Via Prau da Cuort 6<br>
                        7153 Falera<br>
                        Schweiz<br>
                        <a href="mailto:info@mydlak.ch">info@mydlak.ch</a>
                    </p>
                </section>

                <section class="legal-section">
                </section>
            </article>

            <button class="back-btn" id="back-btn">
                <span>←</span> Zurück
            </button>
        </main>

        <footer class="footer-extended">
            <div class="footer-links">
                <a href="/impressum/">Impressum</a>
                <a href="/datenschutz/" class="active">Datenschutz</a>
            </div>
        </footer>
    </div>

    <script>
        // Scroll to top if coming from legal page back button
        if (sessionStorage.getItem('scrollToTop') === 'true') {
            window.scrollTo(0, 0);
            sessionStorage.removeItem('scrollToTop');
        }

        // Event tracking via virtual pageviews
        function trackEvent(eventName) {
            try {
                if (typeof __cfBeacon !== 'undefined' && __cfBeacon.load) {
                    __cfBeacon.load('pageview', {
                        virtualPage: '/event/' + eventName
                    });
                }
            } catch (e) {
                console.log('Tracking not available:', e);
            }
        }

        // Contact Panel Toggle
        const kontaktBtn = document.getElementById('kontakt-btn');
        const closeBtn = document.getElementById('close-btn');
        const contactPanel = document.getElementById('contact-panel');
        const contactOverlay = document.getElementById('contact-overlay');

        kontaktBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (typeof umami !== 'undefined') umami.track('kontakt-opened');
            trackEvent('kontakt-opened-from-datenschutz');
            contactPanel.classList.add('active');
            contactOverlay.classList.add('active');
        });

        closeBtn.addEventListener('click', () => {
            contactPanel.classList.remove('active');
            contactOverlay.classList.remove('active');
        });

        contactOverlay.addEventListener('click', () => {
            contactPanel.classList.remove('active');
            contactOverlay.classList.remove('active');
        });

        // Back button and close button with slide-down transition
        const backBtn = document.getElementById('back-btn');
        const closeBtnLegal = document.getElementById('close-btn-legal');

        const closeAndGoBack = () => {
            trackEvent('back-from-datenschutz');
            sessionStorage.setItem('scrollToTop', 'true');
            document.body.classList.add('page-exit-down');
            setTimeout(() => {
                window.history.back();
            }, 500);
        };

        const closeAndGoHome = () => {
            trackEvent('close-from-datenschutz');
            document.body.classList.add('page-exit-down');
            setTimeout(() => {
                window.location.href = '/';
            }, 500);
        };

        backBtn.addEventListener('click', closeAndGoBack);
        closeBtnLegal.addEventListener('click', closeAndGoHome);

        // Remove page-enter class after animation
        setTimeout(() => {
            document.body.classList.remove('page-enter');
        }, 600);

        // Pocketbase helpers & rendering (contact)
        const PB_BASE = 'https://mydlak-pocketbase.fly.dev';

        async function fetchCollectionFirst(collection) {
            const url = `${PB_BASE}/api/collections/${collection}/records?perPage=1`;
            const res = await fetch(url);
            if (!res.ok) throw new Error(`Failed to fetch ${collection}`);
            const data = await res.json();
            return (data && Array.isArray(data.items) && data.items.length) ? data.items[0] : null;
        }

        (function initContact() {
            const el = document.getElementById('contact-content');
            if (!el) return;

            fetchCollectionFirst('contact')
                .then(rec => {
                    if (!rec) return;
                    if (rec.html) {
                        el.innerHTML = rec.html;
                        return;
                    }
                    const name = rec.name || 'Justyna Mydlak';
                    const title = rec.title || 'MSc Architektin USI AAM';
                    const company = rec.company || 'Mydlak Architektur GmbH';
                    const address = rec.address || 'Via Prau da Cuort 6<br>7153 Falera';
                    const email = rec.email || 'justyna@mydlak.ch';
                    el.innerHTML = `
                        <h2>Kontakt</h2>
                        <div class="contact-info-simple">
                            <p>${name}<br>${title}<br>${company}<br>${address}</p>
                            <a href="mailto:${email}">Email</a>
                        </div>`;
                })
                .catch(err => {
                    console.log('contact load error', err);
                });
        })();
    </script>
    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js'
        data-cf-beacon='{"token": "25c2069b2f03483c8a41850f2fc04774"}'></script>
    <!-- End Cloudflare Web Analytics -->
</body>

</html>